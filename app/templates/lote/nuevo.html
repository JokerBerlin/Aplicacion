{% extends "base.html" %}
{% block imports %}
<script type="text/javascript" src="/static/js/crearLote.js"></script>
<script type="text/javascript">
//filtro de clientes por dni o numero documento ajax

$(document).ready(function(){
        $( "#inpt-proveedor" ).focus();
        $( "#inpt-producto" ).autocomplete({
        source: function (request, response) {

          var datos = {nombreProducto: $("#inpt-producto").val()};
          var sendData = JSON.stringify(datos);
          $.ajax({
              type: "POST",
              dataType: "json",
              url: "/producto/buscar/",
              data: sendData,
              contentType: "application/json; charset=utf-8",
              async: false,
              cache: false,
              CrossDomain: true,
              success: function (result) {
              var ListasProductos = result['productos'];
              response($.map(ListasProductos, function (item) {

                  return {label:item.nombre,
                        idproducto: item.id};

              }));


              }
          });
      },
      minLength: 1,
      select: function (event, ui) {

      }
  });

        $( "#inpt-proveedor" ).autocomplete({
        source: function (request, response) {

          var datos = {nombreProveedor: $("#inpt-proveedor").val()};
          var sendData = JSON.stringify(datos);
          $.ajax({
              type: "POST",
              dataType: "json",
              url: "/proveedor/buscar/",
              data: sendData,
              contentType: "application/json; charset=utf-8",
              async: false,
              cache: false,
              CrossDomain: true,

              success: function (result) {
              var ListasProveedores = result['proveedores'];
              response($.map(ListasProveedores, function (item) {
                 var valorProveedor = document.getElementById('inpt-proveedor').value;
                if( isNaN(valorProveedor) ){
                    return {label: item.nombre};
                }else{
                    return {label: item.documento};
                }
                    }));
                }
            });
        },
        minLength: 1,
        select: function (event, ui) {


          $('#inpt-recibo').focus();
      }

  });
        $( "#inpt-recibo" ).autocomplete({
        source: function (request, response) {

          var datos = {nombreRecibo: $("#inpt-recibo").val()};
          var sendData = JSON.stringify(datos);
          $.ajax({
              type: "POST",
              dataType: "json",
              url: "/recibo/buscar/",
              data: sendData,
              contentType: "application/json; charset=utf-8",
              async: false,
              cache: false,
              CrossDomain: true,

              success: function (result) {
              var ListasRecibos = result['recibos'];
              response($.map(ListasRecibos, function (item) {
                 var valorRecibo = document.getElementById('inpt-recibo').value;
                if( isNaN(valorRecibo) ){
                    return {label: item.nombre};
                }
                    }));
                }
            });
        },
        minLength: 1,
        select: function (event, ui) {


          $('#inpt-almacen').focus();
      }

  });

        $( "#inpt-almacen" ).autocomplete({
        source: function (request, response) {

          var datos = {nombreAlmacen: $("#inpt-almacen").val()};
          var sendData = JSON.stringify(datos);
          $.ajax({
              type: "POST",
              dataType: "json",
              url: "/almacen/buscar/",
              data: sendData,
              contentType: "application/json; charset=utf-8",
              async: false,
              cache: false,
              CrossDomain: true,

              success: function (result) {
              var ListasAlmacen = result['almacenes'];
              response($.map(ListasAlmacen, function (item) {
                 var valorAlmacen = document.getElementById('inpt-almacen').value;
                if( isNaN(valorAlmacen) ){
                    return {label: item.nombre};
                }
                    }));
                }
            });
        },
        minLength: 1,
        select: function (event, ui) {
            

          $('#inpt-producto').focus();
      }

  });

  });


</script>

 <style>
    ul.ui-autocomplete {
        z-index: 1100;
    }
    #content{
        position: absolute;
        min-height: 50%;
        width: 80%;
        top: 20%;
        left: 5%;
    }

    .selected{
        cursor: pointer;
    }
    .selected:hover{
        background-color: #0585C0;
        color: white;
    }
    .seleccionada{
        background-color: #0585C0;
        color: white;
    }
</style>
{% endblock %}


{% block title %}
Nuevo Lote
{% endblock %}

{% block content %}

<p id="demo"></p>

    <div class="row">
        <div class="col-sm-12">
            <div class="white-box">
                <h3 class="box-title">Nuevo Lote</h3>
                <!--<form method="post" enctype="multipart/form-data">
                  {% csrf_token %}-->


                <label for="id_nombre">Proveedor:</label>
                <br>
                <input type="text" id="inpt-proveedor" placeholder="documente o Nombre Proveedor..." name="inpt-proveedor" class="form-control">
                <br>
                <label for="id_nombre">Recibo:</label>
                <br>
                <input type="text" id="inpt-recibo" placeholder="Nombre Recibo..." name="inpt-recibo" class="form-control">
                <br>
                <label for="id_nombre">Almacen:</label>
                <br>
                <input type="text" id="inpt-almacen" placeholder="Nombre Almacen..." name="inpt-almacen" class="form-control">
                <br>
                <label for="id_nombre">Producto:</label>
                <br>
                <input type="text" name="inpt-producto" id="inpt-producto" required="" class="form-control" maxlength="45">
                <br>

                <br>
                <label for="id_nombre">Cantidad:</label>
                <br>

                <input type="number" name="cantidad" id="cantidad" required="" class="form-control" >
                <br>
                <button id="bt_add" class="btn btn-success">Agregar</button>
                <button id="bt_del" class="btn btn-warning">Eliminar</button>
                <button id="bt_delall" class="btn btn-danger">Eliminar todo</button>

                    <div class="row">
                        <div class="form-group">
                            <label ><center>Concepto Operación</center></label>
                            <table id="tabla" name="tablacontenido" class="table table-bordered">
                            <thead>
                                <tr>
                                    <td>Nº</td>
                                    <td>Cantidad</td>
                                    <td>Proveedor</td>
                                    <td>Recibo</td>
                                    <td>Almacen</td>
                                    <td>Producto</td>
                                </tr>
                            </thead>


                            </table>

                            <br>
                        </div>
                            <br>

                        <button id="bt_GenerarVenta" class="btn btn-success">Generar Lote</button>
                      <!--</form>-->
                    </div>

                    <div class="row">
                        <div class="form-group">
                            <div class="col-sm-8 col-md-8 col-lg-6">
                                <div id="tabs" style="display:none;">
                                    <table id="listaProducto"></table>
                                    <div id="pagerlistaProducto"  style="text-align: center;"></div>
                                </div>
                            </div>

                            <div class="col-sm-2 col-md-2 col-lg-4">

                            </div>
                        </div>
                    </div>


    </div>
  </div>
</div>

{% endblock %}
