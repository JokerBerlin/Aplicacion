{% extends "base.html" %}
{% block imports %}

<script type="text/javascript">
    function seleccionarTipo(){
        console.log(document.getElementById('cmbTipoOperacion').value);
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "/Caja/buscar-detalle/",
            data: {

                'tipoOperacion': document.getElementById('cmbTipoOperacion').value,
            },
            async: false,
            success: function(data) {
                console.log(data);
                var cmbOperacion = document.getElementById('cmbOperacion');
                if (data.detalle == ''){
                    cmboOperacion.value = '';
                } else {
                  cmbOperacion.options.length=0;
                  for (var i = 0; i < data.length; i+=1) {
                      var option = document.createElement('option');
                      option.value = data[i].id;
                      option.text = data[i].nombre;
                      cmbOperacion.appendChild(option);
                  }
                }
            },

        });
    }
</script>


{% endblock %}

{% block title %}
Registrar Operacion
{% endblock %}

{% block content %}
<div class="row">
      <div class="col-sm-12">
          <div class="white-box">
              <h3 class="box-title">Formulario de apertura de caja</h3>
              <form action="/Caja/movimiento/" method="post" enctype="multipart/form-data">

        <ul>
				{% load widget_tweaks %}
				{% csrf_token %}
					<div class="form-group">
					<!--<label for="cmbTipo">Tipo de operacion</label>
					<select name="cmbTipo" id="cmbTipo" class="form-control" required>
            {% for tipoOperacion in tipoOperaciones %}
							<option value="{{ tipoOperacion.id }}">
								{{ tipoOperacion.nombre }}
							</option>
						{% endfor %}
					</select>-->
          <label for="">Tipo de operación</label>
          <select name="cmbTipoOperacion" id="cmbTipoOperacion" onchange="seleccionarTipo();"class="form-control" required>
						{% for tipoOperacion in tipoOperaciones %}
							<option value="{{ tipoOperacion.id }}">
								{{ tipoOperacion.nombre }}
							</option>
						{% endfor %}
					</select>
					<label for="cmbOperacion">Detalle operacion</label>
					<select name="cmbOperacion" id="cmbOperacion" class="form-control" required>
						{% for operacion in detalleOperaciones %}
							<option value="{{ operacion.id }}">
								{{ operacion.nombre }}
							</option>
						{% endfor %}
					</select>

					<label for="monto">Monto</label>
					<input type="number" name="monto" id="monto" class="form-control" value="0.00" step="0.1" placeholder="0.0">

          <label for="monto">Descripción</label>
          <textarea id="id_descripcion" name="descripcion" rows="4" cols="50" class="form-control"></textarea>
					<button class="btn btn-success" data-toggle="modal" style="margin-top: 1em">Aperturar Caja</button>
				</ul>
				</form>
      </div>
      </div>
    </div>
{% endblock %}
